/* DarkVeil Platform Styles - Поддержка всех платформ */

:root {
  /* Desktop variables */
  --dv-dpr: 1;
  --dv-quality: high;
  --dv-fps: 60;
}

/* ============ DESKTOP STYLES ============ */
@media (min-width: 1025px) and (hover: hover) and (pointer: fine) {
  :root {
    --dv-quality: high;
    --dv-fps: 60;
  }

  .dark-veil-container {
    background: var(--bg-primary, #0f0f0f);
    border-radius: 0;
  }

  .dark-veil-canvas {
    cursor: default;
    will-change: auto;
  }
}

/* ============ TABLET STYLES ============ */
@media (max-width: 1024px) and (min-width: 600px) {
  :root {
    --dv-quality: medium;
    --dv-fps: 30;
  }

  .dark-veil-container {
    background: var(--bg-primary, #0f0f0f);
  }

  .dark-veil-canvas {
    will-change: transform;
    image-rendering: -webkit-optimize-contrast;
  }

  /* Tablet-specific optimizations */
  .dark-veil-container {
    touch-action: manipulation;
  }
}

/* ============ MOBILE STYLES ============ */
@media (max-width: 599px) {
  :root {
    --dv-quality: low;
    --dv-fps: 24;
  }

  .dark-veil-container,
  .darkveil-mobile {
    background: #000;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    z-index: -1;
  }

  .dark-veil-canvas,
  .darkveil-mobile-canvas {
    image-rendering: -ms-interpolation-mode-nearest-neighbor;
    image-rendering: pixelated;
    touch-action: none;
    -webkit-user-select: none;
    user-select: none;
  }

  /* Prevent scale on iOS */
  input,
  button {
    font-size: 16px;
  }

  .dark-veil-container * {
    -webkit-touch-callout: none;
  }
}

/* ============ iOS SPECIFIC ============ */
@supports (-webkit-appearance: none) {
  .dark-veil-container.ios,
  .darkveil-mobile.ios {
    /* iOS WebGL context optimization */
    -webkit-user-select: none;
    user-select: none;
    -webkit-touch-callout: none;
  }

  .dark-veil-canvas.ios,
  .darkveil-mobile-canvas.ios {
    -webkit-appearance: none;
    appearance: none;
    -webkit-transform: translate3d(0, 0, 0);
    transform: translate3d(0, 0, 0);
    backface-visibility: hidden;
    perspective: 1000;
  }

  /* iPhone notch support */
  @supports (padding: max(0px)) {
    .dark-veil-container.ios,
    .darkveil-mobile.ios {
      padding-top: max(0px, env(safe-area-inset-top));
      padding-left: max(0px, env(safe-area-inset-left));
      padding-right: max(0px, env(safe-area-inset-right));
      padding-bottom: max(0px, env(safe-area-inset-bottom));
    }
  }
}

/* ============ Android SPECIFIC ============ */
[data-platform='android'] .dark-veil-container,
[data-platform='android'] .darkveil-mobile {
  background: #000;
}

[data-platform='android'] .dark-veil-canvas,
[data-platform='android'] .darkveil-mobile-canvas {
  will-change: transform;
  image-rendering: auto;
}

/* Android status bar integration */
@media (max-height: 600px) {
  .dark-veil-container,
  .darkveil-mobile {
    position: absolute;
    height: 100vh;
  }

  .dark-veil-canvas,
  .darkveil-mobile-canvas {
    max-height: 100vh;
  }
}

/* ============ ORIENTATION RESPONSIVE ============ */
@media (orientation: portrait) {
  .dark-veil-container,
  .darkveil-mobile {
    display: flex;
    flex-direction: column;
  }

  .dark-veil-canvas,
  .darkveil-mobile-canvas {
    flex: 1;
    width: 100%;
    height: 100%;
  }
}

@media (orientation: landscape) {
  .dark-veil-container,
  .darkveil-mobile {
    display: flex;
    flex-direction: row;
  }

  .dark-veil-canvas,
  .darkveil-mobile-canvas {
    width: 100%;
    height: 100%;
    flex: 1;
  }
}

/* ============ HIGH DPI SUPPORT ============ */
@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
  .dark-veil-canvas,
  .darkveil-mobile-canvas {
    image-rendering: -webkit-optimize-contrast;
    backface-visibility: hidden;
  }
}

@media (-webkit-min-device-pixel-ratio: 3), (min-resolution: 288dpi) {
  .dark-veil-canvas,
  .darkveil-mobile-canvas {
    image-rendering: -webkit-optimize-contrast;
    image-rendering: crisp-edges;
  }
}

/* ============ LOW POWER MODE SUPPORT ============ */
@media (prefers-reduced-motion: reduce) {
  .dark-veil-canvas,
  .darkveil-mobile-canvas {
    animation: none !important;
    transition: none !important;
  }
}

/* ============ DARK MODE SUPPORT ============ */
@media (prefers-color-scheme: dark) {
  .dark-veil-container,
  .darkveil-mobile {
    background: #000;
  }
}

@media (prefers-color-scheme: light) {
  .dark-veil-container,
  .darkveil-mobile {
    background: #f5f5f5;
  }
}

/* ============ LANDSCAPE SMALL HEIGHT ============ */
@media (orientation: landscape) and (max-height: 500px) {
  .dark-veil-container,
  .darkveil-mobile {
    height: 100vh;
  }

  .dark-veil-canvas,
  .darkveil-mobile-canvas {
    height: 100%;
    min-height: 100%;
  }
}

/* ============ COMMON UTILITIES ============ */
.dark-veil-container,
.darkveil-mobile {
  position: relative;
  overflow: hidden;
  box-sizing: border-box;
}

.dark-veil-canvas,
.darkveil-mobile-canvas {
  display: block;
  margin: 0;
  padding: 0;
  border: none;
  outline: none;
}

/* Disable default scroll behavior */
.dark-veil-container,
.darkveil-mobile {
  -webkit-user-select: none;
  -webkit-touch-callout: none;
  user-select: none;
  touch-action: none;
}

/* Improve rendering performance */
.dark-veil-canvas,
.darkveil-mobile-canvas {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  width: 100%;
  height: 100%;
}

/* ============ ACCESSIBILITY ============ */
@media (prefers-contrast: more) {
  .dark-veil-canvas,
  .darkveil-mobile-canvas {
    filter: contrast(1.2);
  }
}

/* Reduced transparency for better contrast */
@media (prefers-contrast: more) and (prefers-color-scheme: dark) {
  .dark-veil-container,
  .darkveil-mobile {
    background: #0a0a0a;
  }
}

/* ============ BROWSER-SPECIFIC FIXES ============ */
/* Safari */
@supports (-webkit-appearance: none) {
  .dark-veil-canvas,
  .darkveil-mobile-canvas {
    -webkit-font-smoothing: antialiased;
    -webkit-appearance: none;
    appearance: none;
  }
}

/* Chrome/Edge */
@supports (-webkit-app-region: drag) {
  .dark-veil-canvas,
  .darkveil-mobile-canvas {
    will-change: transform;
  }
}
